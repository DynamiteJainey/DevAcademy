<!DOCTYPE html>
<html>
	<head>
		<title>Async JavaScript Tutorial</title>
	</head>

	<body id="body" onmouseover="">
		<h2 >Please Select what fruit you want:</h2>
		<p >Type "0" for Strawberry, "1" for Grapes, "2" for Banana, and "3" for Apple</p>
		<input id="demo" type="text" placeholder="input your choice">
		<input id="demi" type="text" placeholder="input your choice">
		
		<h2>Please Select what holder you want:</h2>
		<p >Type "0" for Cone, "1" for Cup, "2" for Stick</p>
		<input id="dart" type="text" placeholder="input your choice">
		
		<h2 >Please Select what toppings you want:</h2>
		<p >Type "0" for Chocolate, "1" for Sprinkles, "2" for Oreo</p>
		<input id="deer" type="text" placeholder="input your choice">
		<br><br>
		<button onclick="kitchen()">Place My Order</button>
		<script>
			//"use strict";
			let w = document.getElementById("demo");
			let x = document.getElementById("demi");
			let y = document.getElementById("dart");
			let z = document.getElementById("deer");
			
			// Ice Cream Shop Tutorial
			const stocks = {
				fruits: ["Strawberry", "Grapes", "Banana", "Apple"],
				liquid: ["Water", "Ice"],
				holder: ["Cone", "Cup", "Stick"],
				toppings: ["Chocolate", "Sprinkles", "Oreo"]
			}
			
			function toppings_choice() {
				return new Promise( (resolve, reject) => {
					setTimeout(()=> {
						resolve( document.write("TP = What toppings do you want? <br>"))
					}, 2000)
					setTimeout(()=> {
						resolve( document.write(`TP = I want ${stocks.toppings[z.value]} <br>`))
					}, 4000)
				})
			}
			
			let is_shop_open = true;
			
			function time(ms) {
				return new Promise( (resolve, reject) => {
					if (is_shop_open) {
						setTimeout(resolve, ms);
					}
					
					else {
						reject(document.write("Our shop is closed"))
					}
				});
			}
			
			async function kitchen() {
				try{
					// main code or instructions
					await time(2000)
					document.write("Shop has been opened <br>")
					
					await time(2000)
					document.write(`${stocks.fruits[w.value]} was selected <br>`)
					if (x.value != ""){
						document.write(`${stocks.fruits[x.value]} also selected <br>`)
					}
					
					await time(2000)
					document.write("Fruits has been chopped. <br>")
					
					await time(1000)
					document.write(`${stocks.liquid[0]} and ${stocks.liquid[1]} added <br>`)
					
					await toppings_choice();
					
					await time(1000)
					document.write("Start the Machine. <br>")
					
					await time(3000)
					document.write(`Ice Cream placed on ${stocks.holder[y.value]}. <br>`)
					
					await time(2000)
					document.write(`${stocks.toppings[z.value]} added as toppings <br>`)
					
					await time(2000)
					document.write("Serve Ice Cream <br>")
				}
				
				catch(error){
					// errors are handled
					document.write("Customers have left", error.message)
				}
				
				finally {
					document.write("Day over, shop closed.");
				}
			}
			
			
		</script>
	</body>

</html>
